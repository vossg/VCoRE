
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

MESSAGE(STATUS "Processing VCore ")

FILE(GLOB_RECURSE _VCORE_LIBRARY_CONFIG_FILES 
                  RELATIVE 
                  "${CMAKE_CURRENT_SOURCE_DIR}"
                  "Source/*CMakeLists.Lib.*.txt")

IF(INRIA_VCORE_DIR)
  FILE(GLOB_RECURSE _INRIA_VCORE_LIBRARY_CONFIG_FILES 
#                    RELATIVE 
#                    "${CMAKE_CURRENT_SOURCE_DIR}"
                    "${INRIA_VCORE_DIR}/*CMakeLists.Lib.*.txt")


  IF(${OSG_CMAKE_PASS} STREQUAL "OSGCOLLECT")
    OSG_ADD_OPT_SUBDIR(INRIA_VCORE_DIR)
  ENDIF()
ELSE()
  RETURN()
ENDIF()

IF(${OSG_CMAKE_PASS} STREQUAL "OSGCOLLECT")
  ADD_CUSTOM_TARGET(VCoreAllLibs)
  ADD_DEPENDENCIES(OSGAllContribLibs VCoreAllLibs)
ENDIF()


FOREACH(_INRIA_VCORE_LIBRARY_CONFIG ${_INRIA_VCORE_LIBRARY_CONFIG_FILES})

  IF(NOT ${_INRIA_VCORE_LIBRARY_CONFIG} MATCHES /OSGAddOns/)
    GET_FILENAME_COMPONENT(VCORE_LIBCONFIGDIR "${_INRIA_VCORE_LIBRARY_CONFIG}" PATH)
    GET_FILENAME_COMPONENT(VCORE_LIBFILENAME  "${_INRIA_VCORE_LIBRARY_CONFIG}" NAME)
    STRING(REPLACE "CMakeLists.Lib." "" VCORE_LIBFILENAME "${VCORE_LIBFILENAME}")
    STRING(REPLACE ".txt"            "" VCORE_LIBFILENAME "${VCORE_LIBFILENAME}")

    SET(OSG_MAIN_LIB_TARGET VCoreAllLibs)

    ADD_SUBDIRECTORY(${VCORE_LIBCONFIGDIR}
                     ${VCORE_LIBFILENAME}/${OSG_PASSDIR_${PASS}} )
  ENDIF()

ENDFOREACH()


FOREACH(_VCORE_LIBRARY_CONFIG ${_VCORE_LIBRARY_CONFIG_FILES})

  GET_FILENAME_COMPONENT(VCORE_LIBCONFIGDIR "${_VCORE_LIBRARY_CONFIG}" PATH)
  GET_FILENAME_COMPONENT(VCORE_LIBFILENAME  "${_VCORE_LIBRARY_CONFIG}" NAME)
  STRING(REPLACE "CMakeLists.Lib." "" VCORE_LIBFILENAME "${VCORE_LIBFILENAME}")
  STRING(REPLACE ".txt"            "" VCORE_LIBFILENAME "${VCORE_LIBFILENAME}")

  SET(OSG_MAIN_LIB_TARGET VCoreAllLibs)

  ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/${VCORE_LIBCONFIGDIR}
                   ${VCORE_LIBFILENAME}/${OSG_PASSDIR_${PASS}} )

ENDFOREACH(_VCORE_LIBRARY_CONFIG ${_VCORE_LIBRARY_CONFIG_FILES})

